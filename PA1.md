# Reproducible Research: Peer Assessment 1
=============================================================

Data of steps given by a person, measured at 5 minutes interval across the day, was registered for October and November of 2012, with a Nike Fuelband device and a samsung galaxy S4 with android 4.1 phone.

The data was downloaded from <a href="https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"> this url </a>, consulted in 15-07-2014 in teh working directory of R-Studio 0.98.507.  


## Loading and preprocessing the data

The data was loaded and processed, keeping only the complete cases (rows without NA) as valid data, the rows with al least one NA value was deleted. 

```r
rm(list=ls()) #cleaning vars
cat("\014")  #clear screen

## LOADING DATA
crudos<-read.table("activity.csv",sep=",",header=T) #names steps date interval

## SELECTING VALID DATA (non na data, days with non data was excluded)
datos<-crudos[complete.cases(crudos),]
```

## What is mean total number of steps taken per day?

The total, mean and median of the steps per each day, was calculated.

```r
# Grouping data per day
A<-1;AA<-1;AAA<-1;fechas<-datos$date[datos$interval==0]
for (i in 1:max(as.numeric(datos$date))) {
  A[i]<-mean(datos$steps[as.numeric(datos$date)==i])
  AA[i]<-sum(datos$steps[as.numeric(datos$date)==i])
  AAA[i]<-median(datos$steps[as.numeric(datos$date)==i])  
}

# Total, mean and median of steps per day
DD<-data.frame(steps=AA[AA!=0],mean=A[AA!=0],median=AAA[AA!=0],date=as.Date(fechas))
```

In brief, we have the following scenario for each day analyzed:

```r
DD
```

```
##    steps    mean median       date
## 1    126  0.4375      0 2012-10-02
## 2  11352 39.4167      0 2012-10-03
## 3  12116 42.0694      0 2012-10-04
## 4  13294 46.1597      0 2012-10-05
## 5  15420 53.5417      0 2012-10-06
## 6  11015 38.2465      0 2012-10-07
## 7  12811 44.4826      0 2012-10-09
## 8   9900 34.3750      0 2012-10-10
## 9  10304 35.7778      0 2012-10-11
## 10 17382 60.3542      0 2012-10-12
## 11 12426 43.1458      0 2012-10-13
## 12 15098 52.4236      0 2012-10-14
## 13 10139 35.2049      0 2012-10-15
## 14 15084 52.3750      0 2012-10-16
## 15 13452 46.7083      0 2012-10-17
## 16 10056 34.9167      0 2012-10-18
## 17 11829 41.0729      0 2012-10-19
## 18 10395 36.0938      0 2012-10-20
## 19  8821 30.6285      0 2012-10-21
## 20 13460 46.7361      0 2012-10-22
## 21  8918 30.9653      0 2012-10-23
## 22  8355 29.0104      0 2012-10-24
## 23  2492  8.6528      0 2012-10-25
## 24  6778 23.5347      0 2012-10-26
## 25 10119 35.1354      0 2012-10-27
## 26 11458 39.7847      0 2012-10-28
## 27  5018 17.4236      0 2012-10-29
## 28  9819 34.0938      0 2012-10-30
## 29 15414 53.5208      0 2012-10-31
## 30 10600 36.8056      0 2012-11-02
## 31 10571 36.7049      0 2012-11-03
## 32 10439 36.2465      0 2012-11-05
## 33  8334 28.9375      0 2012-11-06
## 34 12883 44.7326      0 2012-11-07
## 35  3219 11.1771      0 2012-11-08
## 36 12608 43.7778      0 2012-11-11
## 37 10765 37.3785      0 2012-11-12
## 38  7336 25.4722      0 2012-11-13
## 39    41  0.1424      0 2012-11-15
## 40  5441 18.8924      0 2012-11-16
## 41 14339 49.7882      0 2012-11-17
## 42 15110 52.4653      0 2012-11-18
## 43  8841 30.6979      0 2012-11-19
## 44  4472 15.5278      0 2012-11-20
## 45 12787 44.3993      0 2012-11-21
## 46 20427 70.9271      0 2012-11-22
## 47 21194 73.5903      0 2012-11-23
## 48 14478 50.2708      0 2012-11-24
## 49 11834 41.0903      0 2012-11-25
## 50 11162 38.7569      0 2012-11-26
## 51 13646 47.3819      0 2012-11-27
## 52 10183 35.3576      0 2012-11-28
## 53  7047 24.4688      0 2012-11-29
```

A histogram of the steps in an average day, is shown below:

```r
# histogram of total
hist(DD$steps,xlab="interval")
```

![plot of chunk unnamed-chunk-3](figure/unnamed-chunk-3.png) 


## What is the average daily activity pattern?

The data was grouped per interval, across all days, and their mean, median and total steps were calculated.

```r
## INTERVAL ANALYSIS
#Grouping dat per interval
B<-1;BB<-1;BBB<-1;intervalos<-datos$interval[as.numeric(datos$date)==2]
for (i in 1:length(intervalos)){
  B[i]<-sum(datos$steps[datos$interval==intervalos[i]])
  BB[i]<-mean(datos$steps[datos$interval==intervalos[i]])
  BBB[i]<-median(datos$steps[datos$interval==intervalos[i]])
}

# Total, mean and median of steps per interval
ID<-data.frame(steps=B,mean=BB,median=BBB,interval=intervalos)
```

The table below shows the steps per interval:

```r
ID
```

```
##     steps      mean median interval
## 1      91   1.71698      0        0
## 2      18   0.33962      0        5
## 3       7   0.13208      0       10
## 4       8   0.15094      0       15
## 5       4   0.07547      0       20
## 6     111   2.09434      0       25
## 7      28   0.52830      0       30
## 8      46   0.86792      0       35
## 9       0   0.00000      0       40
## 10     78   1.47170      0       45
## 11     16   0.30189      0       50
## 12      7   0.13208      0       55
## 13     17   0.32075      0      100
## 14     36   0.67925      0      105
## 15      8   0.15094      0      110
## 16     18   0.33962      0      115
## 17      0   0.00000      0      120
## 18     59   1.11321      0      125
## 19     97   1.83019      0      130
## 20      9   0.16981      0      135
## 21      9   0.16981      0      140
## 22     20   0.37736      0      145
## 23     14   0.26415      0      150
## 24      0   0.00000      0      155
## 25      0   0.00000      0      200
## 26      0   0.00000      0      205
## 27     60   1.13208      0      210
## 28      0   0.00000      0      215
## 29      0   0.00000      0      220
## 30      7   0.13208      0      225
## 31      0   0.00000      0      230
## 32     12   0.22642      0      235
## 33      0   0.00000      0      240
## 34      0   0.00000      0      245
## 35     82   1.54717      0      250
## 36     50   0.94340      0      255
## 37      0   0.00000      0      300
## 38      0   0.00000      0      305
## 39      0   0.00000      0      310
## 40      0   0.00000      0      315
## 41     11   0.20755      0      320
## 42     33   0.62264      0      325
## 43     86   1.62264      0      330
## 44     31   0.58491      0      335
## 45     26   0.49057      0      340
## 46      4   0.07547      0      345
## 47      0   0.00000      0      350
## 48      0   0.00000      0      355
## 49     63   1.18868      0      400
## 50     50   0.94340      0      405
## 51    136   2.56604      0      410
## 52      0   0.00000      0      415
## 53     18   0.33962      0      420
## 54     19   0.35849      0      425
## 55    218   4.11321      0      430
## 56     35   0.66038      0      435
## 57    185   3.49057      0      440
## 58     44   0.83019      0      445
## 59    165   3.11321      0      450
## 60     59   1.11321      0      455
## 61      0   0.00000      0      500
## 62     83   1.56604      0      505
## 63    159   3.00000      0      510
## 64    119   2.24528      0      515
## 65    176   3.32075      0      520
## 66    157   2.96226      0      525
## 67    111   2.09434      0      530
## 68    321   6.05660      0      535
## 69    849  16.01887      0      540
## 70    972  18.33962      0      545
## 71   2091  39.45283      0      550
## 72   2358  44.49057      0      555
## 73   1669  31.49057      0      600
## 74   2611  49.26415      0      605
## 75   2850  53.77358      0      610
## 76   3363  63.45283      0      615
## 77   2648  49.96226      0      620
## 78   2495  47.07547      0      625
## 79   2764  52.15094      0      630
## 80   2085  39.33962      0      635
## 81   2333  44.01887      0      640
## 82   2341  44.16981      0      645
## 83   1980  37.35849      8      650
## 84   2599  49.03774     13      655
## 85   2322  43.81132      7      700
## 86   2352  44.37736     13      705
## 87   2677  50.50943     14      710
## 88   2889  54.50943      0      715
## 89   2646  49.92453      0      720
## 90   2702  50.98113     12      725
## 91   2951  55.67925      0      730
## 92   2349  44.32075      0      735
## 93   2770  52.26415     15      740
## 94   3686  69.54717     19      745
## 95   3066  57.84906     19      750
## 96   2976  56.15094     28      755
## 97   3889  73.37736     41      800
## 98   3615  68.20755     25      805
## 99   6860 129.43396     32      810
## 100  8349 157.52830     13      815
## 101  9071 171.15094     45      820
## 102  8236 155.39623     33      825
## 103  9397 177.30189     37      830
## 104 10927 206.16981     19      835
## 105 10384 195.92453     51      840
## 106  9517 179.56604     60      845
## 107  9720 183.39623     16      850
## 108  8852 167.01887     43      855
## 109  7603 143.45283     20      900
## 110  6574 124.03774      8      905
## 111  5783 109.11321     31      910
## 112  5730 108.11321     15      915
## 113  5497 103.71698     16      920
## 114  5086  95.96226      0      925
## 115  3509  66.20755      0      930
## 116  2397  45.22642      0      935
## 117  1314  24.79245      0      940
## 118  2054  38.75472      0      945
## 119  1854  34.98113      0      950
## 120  1116  21.05660      0      955
## 121  2150  40.56604      0     1000
## 122  1430  26.98113      0     1005
## 123  2248  42.41509      0     1010
## 124  2791  52.66038      0     1015
## 125  2063  38.92453      0     1020
## 126  2692  50.79245      0     1025
## 127  2347  44.28302      0     1030
## 128  1983  37.41509      0     1035
## 129  1839  34.69811      0     1040
## 130  1502  28.33962      0     1045
## 131  1330  25.09434      0     1050
## 132  1693  31.94340      0     1055
## 133  1662  31.35849      0     1100
## 134  1573  29.67925      0     1105
## 135  1130  21.32075      0     1110
## 136  1354  25.54717      0     1115
## 137  1504  28.37736      0     1120
## 138  1403  26.47170      0     1125
## 139  1772  33.43396      0     1130
## 140  2649  49.98113      0     1135
## 141  2228  42.03774      0     1140
## 142  2364  44.60377      0     1145
## 143  2440  46.03774      0     1150
## 144  3137  59.18868      0     1155
## 145  3385  63.86792      0     1200
## 146  4648  87.69811      0     1205
## 147  5027  94.84906      6     1210
## 148  4917  92.77358     10     1215
## 149  3360  63.39623      0     1220
## 150  2659  50.16981      0     1225
## 151  2887  54.47170      0     1230
## 152  1718  32.41509      0     1235
## 153  1406  26.52830      0     1240
## 154  2000  37.73585      0     1245
## 155  2388  45.05660      0     1250
## 156  3566  67.28302      0     1255
## 157  2244  42.33962      0     1300
## 158  2114  39.88679      0     1305
## 159  2293  43.26415      0     1310
## 160  2172  40.98113      0     1315
## 161  2451  46.24528      0     1320
## 162  2991  56.43396      0     1325
## 163  2266  42.75472      0     1330
## 164  1332  25.13208      0     1335
## 165  2118  39.96226      0     1340
## 166  2838  53.54717      0     1345
## 167  2508  47.32075      0     1350
## 168  3223  60.81132      0     1355
## 169  2955  55.75472      0     1400
## 170  2754  51.96226      0     1405
## 171  2310  43.58491      0     1410
## 172  2581  48.69811      0     1415
## 173  1880  35.47170      0     1420
## 174  1990  37.54717      0     1425
## 175  2218  41.84906      0     1430
## 176  1458  27.50943      0     1435
## 177   907  17.11321      0     1440
## 178  1382  26.07547      0     1445
## 179  2312  43.62264      0     1450
## 180  2320  43.77358      0     1455
## 181  1591  30.01887      0     1500
## 182  1912  36.07547      0     1505
## 183  1881  35.49057      0     1510
## 184  2059  38.84906      0     1515
## 185  2436  45.96226      0     1520
## 186  2531  47.75472      0     1525
## 187  2551  48.13208      0     1530
## 188  3462  65.32075      0     1535
## 189  4394  82.90566      0     1540
## 190  5229  98.66038      0     1545
## 191  5412 102.11321      0     1550
## 192  4450  83.96226      0     1555
## 193  3293  62.13208      0     1600
## 194  3399  64.13208      0     1605
## 195  3951  74.54717      0     1610
## 196  3348  63.16981      0     1615
## 197  3016  56.90566      0     1620
## 198  3168  59.77358      0     1625
## 199  2325  43.86792      0     1630
## 200  2044  38.56604      0     1635
## 201  2367  44.66038      0     1640
## 202  2409  45.45283      0     1645
## 203  2449  46.20755      0     1650
## 204  2315  43.67925      0     1655
## 205  2471  46.62264      0     1700
## 206  2984  56.30189      0     1705
## 207  2688  50.71698      0     1710
## 208  3245  61.22642      7     1715
## 209  3854  72.71698      7     1720
## 210  4184  78.94340      0     1725
## 211  3654  68.94340      7     1730
## 212  3162  59.66038      7     1735
## 213  3980  75.09434     26     1740
## 214  2995  56.50943      7     1745
## 215  1843  34.77358      0     1750
## 216  1985  37.45283     10     1755
## 217  2156  40.67925     15     1800
## 218  3075  58.01887     18     1805
## 219  3959  74.69811     26     1810
## 220  4522  85.32075     25     1815
## 221  3141  59.26415     24     1820
## 222  3592  67.77358      9     1825
## 223  4118  77.69811     33     1830
## 224  3935  74.24528     26     1835
## 225  4523  85.33962     34     1840
## 226  5271  99.45283     42     1845
## 227  4589  86.58491     33     1850
## 228  4537  85.60377     30     1855
## 229  4498  84.86792     33     1900
## 230  4125  77.83019     30     1905
## 231  3076  58.03774      8     1910
## 232  2828  53.35849      8     1915
## 233  1925  36.32075      7     1920
## 234  1098  20.71698      0     1925
## 235  1452  27.39623      0     1930
## 236  2121  40.01887      0     1935
## 237  1601  30.20755      0     1940
## 238  1354  25.54717      0     1945
## 239  2420  45.66038      0     1950
## 240  1777  33.52830      0     1955
## 241  1040  19.62264      0     2000
## 242  1008  19.01887      0     2005
## 243  1025  19.33962      0     2010
## 244  1767  33.33962      0     2015
## 245  1421  26.81132      0     2020
## 246  1122  21.16981      0     2025
## 247  1447  27.30189      0     2030
## 248  1131  21.33962      0     2035
## 249  1036  19.54717      0     2040
## 250  1130  21.32075      0     2045
## 251  1712  32.30189      0     2050
## 252  1068  20.15094      0     2055
## 253   845  15.94340      0     2100
## 254   913  17.22642      0     2105
## 255  1243  23.45283      0     2110
## 256  1020  19.24528      0     2115
## 257   660  12.45283      0     2120
## 258   425   8.01887      0     2125
## 259   777  14.66038      0     2130
## 260   864  16.30189      0     2135
## 261   460   8.67925      0     2140
## 262   413   7.79245      0     2145
## 263   431   8.13208      0     2150
## 264   139   2.62264      0     2155
## 265    77   1.45283      0     2200
## 266   195   3.67925      0     2205
## 267   255   4.81132      0     2210
## 268   451   8.50943      0     2215
## 269   375   7.07547      0     2220
## 270   461   8.69811      0     2225
## 271   517   9.75472      0     2230
## 272   117   2.20755      0     2235
## 273    17   0.32075      0     2240
## 274     6   0.11321      0     2245
## 275    85   1.60377      0     2250
## 276   244   4.60377      0     2255
## 277   175   3.30189      0     2300
## 278   151   2.84906      0     2305
## 279     0   0.00000      0     2310
## 280    44   0.83019      0     2315
## 281    51   0.96226      0     2320
## 282    84   1.58491      0     2325
## 283   138   2.60377      0     2330
## 284   249   4.69811      0     2335
## 285   175   3.30189      0     2340
## 286    34   0.64151      0     2345
## 287    12   0.22642      0     2350
## 288    57   1.07547      0     2355
```

A plot of the mean of steps per interval is as follow:

```r
#Plot steps per interval
plot(ID$interval,ID$mean,xlab="interval",ylab="mean")
```

![plot of chunk unnamed-chunk-6](figure/unnamed-chunk-6.png) 

The interval with the maximum steps in average is:

```r
#Interval with max average steps
ID[ID$mean==max(ID$mean),]
```

```
##     steps  mean median interval
## 104 10927 206.2     19      835
```


## Imputing missing values

The total number of Na values in raw data is:


```r
NANumber<-length(crudos$steps[is.na(crudos$steps)])
NANumber
```

[1] 2304

Considering the total the raw data, the NA values represent a percentage of (expressed as decimal):

```r
NANumber/length(crudos$steps)
```

[1] 0.1311

Each interval was inspected, and all NA values was replaced for the respective interval mean across all days (considering only valid data). 

```r
##MISSING DATA
#Number of NA
NANumber<-length(crudos$steps[is.na(crudos$steps)])

#Replacing the NA values (for the mean of the interval)
RD<-crudos;temp<-0
for (i in 1:length(RD$steps)){
  if(is.na(RD$steps[i])) {RD$steps[i]<-ID$mean[ID$interval==RD$interval[i]]}
}
```

A sample of the original and replaced data is shown below:

```r
data.frame(crudos[280:300,],RD[280:300,],Int.mean=c(ID$mean[280:288],ID$mean[1:12]))
```

```
##     steps       date interval steps.1     date.1 interval.1 Int.mean
## 280    NA 2012-10-01     2315  0.8302 2012-10-01       2315  0.83019
## 281    NA 2012-10-01     2320  0.9623 2012-10-01       2320  0.96226
## 282    NA 2012-10-01     2325  1.5849 2012-10-01       2325  1.58491
## 283    NA 2012-10-01     2330  2.6038 2012-10-01       2330  2.60377
## 284    NA 2012-10-01     2335  4.6981 2012-10-01       2335  4.69811
## 285    NA 2012-10-01     2340  3.3019 2012-10-01       2340  3.30189
## 286    NA 2012-10-01     2345  0.6415 2012-10-01       2345  0.64151
## 287    NA 2012-10-01     2350  0.2264 2012-10-01       2350  0.22642
## 288    NA 2012-10-01     2355  1.0755 2012-10-01       2355  1.07547
## 289     0 2012-10-02        0  0.0000 2012-10-02          0  1.71698
## 290     0 2012-10-02        5  0.0000 2012-10-02          5  0.33962
## 291     0 2012-10-02       10  0.0000 2012-10-02         10  0.13208
## 292     0 2012-10-02       15  0.0000 2012-10-02         15  0.15094
## 293     0 2012-10-02       20  0.0000 2012-10-02         20  0.07547
## 294     0 2012-10-02       25  0.0000 2012-10-02         25  2.09434
## 295     0 2012-10-02       30  0.0000 2012-10-02         30  0.52830
## 296     0 2012-10-02       35  0.0000 2012-10-02         35  0.86792
## 297     0 2012-10-02       40  0.0000 2012-10-02         40  0.00000
## 298     0 2012-10-02       45  0.0000 2012-10-02         45  1.47170
## 299     0 2012-10-02       50  0.0000 2012-10-02         50  0.30189
## 300     0 2012-10-02       55  0.0000 2012-10-02         55  0.13208
```
From left to right, the column 1, 2 and 3 represent the raw data. Columns 4, 5 and 6 represent the replaced data, and the last one show the mean of the respective interval.

A histogram of the steps in an average day, of the replaced data is shown below:

```r
# histogram of total
hist(RD$steps,xlab="interval")
```

![plot of chunk unnamed-chunk-12](figure/unnamed-chunk-12.png) 

Replaced data were grouped by day, as was done with the previous set.

```r
#Grouping NEW data per day
AR<-1;AAR<-1;AAAR<-1; fechasR<-as.Date(RD$date[RD$interval==0])

for (i in 1:length(fechasR)) {
  AR[i]<-sum(RD$steps[as.numeric(RD$date)==i])
  AAR[i]<-mean(RD$steps[as.numeric(RD$date)==i])
  AAAR[i]<-median(RD$steps[as.numeric(RD$date)==i])
}

# Total, mean and median of steps per day, with replaced data
RDD<-data.frame(steps=AR[AR!=0],mean=AAR[AR!=0],median=AAAR[AR!=0], date=as.Date(fechasR))

#Histogram
#hist(RDD$steps)
```

The scenario for each day, with replaced data is:

```r
# Total, mean and median of steps per day, with replaced data
RDD
```

```
##    steps    mean median       date
## 1  10766 37.3826  34.11 2012-10-01
## 2    126  0.4375   0.00 2012-10-02
## 3  11352 39.4167   0.00 2012-10-03
## 4  12116 42.0694   0.00 2012-10-04
## 5  13294 46.1597   0.00 2012-10-05
## 6  15420 53.5417   0.00 2012-10-06
## 7  11015 38.2465   0.00 2012-10-07
## 8  10766 37.3826  34.11 2012-10-08
## 9  12811 44.4826   0.00 2012-10-09
## 10  9900 34.3750   0.00 2012-10-10
## 11 10304 35.7778   0.00 2012-10-11
## 12 17382 60.3542   0.00 2012-10-12
## 13 12426 43.1458   0.00 2012-10-13
## 14 15098 52.4236   0.00 2012-10-14
## 15 10139 35.2049   0.00 2012-10-15
## 16 15084 52.3750   0.00 2012-10-16
## 17 13452 46.7083   0.00 2012-10-17
## 18 10056 34.9167   0.00 2012-10-18
## 19 11829 41.0729   0.00 2012-10-19
## 20 10395 36.0938   0.00 2012-10-20
## 21  8821 30.6285   0.00 2012-10-21
## 22 13460 46.7361   0.00 2012-10-22
## 23  8918 30.9653   0.00 2012-10-23
## 24  8355 29.0104   0.00 2012-10-24
## 25  2492  8.6528   0.00 2012-10-25
## 26  6778 23.5347   0.00 2012-10-26
## 27 10119 35.1354   0.00 2012-10-27
## 28 11458 39.7847   0.00 2012-10-28
## 29  5018 17.4236   0.00 2012-10-29
## 30  9819 34.0938   0.00 2012-10-30
## 31 15414 53.5208   0.00 2012-10-31
## 32 10766 37.3826  34.11 2012-11-01
## 33 10600 36.8056   0.00 2012-11-02
## 34 10571 36.7049   0.00 2012-11-03
## 35 10766 37.3826  34.11 2012-11-04
## 36 10439 36.2465   0.00 2012-11-05
## 37  8334 28.9375   0.00 2012-11-06
## 38 12883 44.7326   0.00 2012-11-07
## 39  3219 11.1771   0.00 2012-11-08
## 40 10766 37.3826  34.11 2012-11-09
## 41 10766 37.3826  34.11 2012-11-10
## 42 12608 43.7778   0.00 2012-11-11
## 43 10765 37.3785   0.00 2012-11-12
## 44  7336 25.4722   0.00 2012-11-13
## 45 10766 37.3826  34.11 2012-11-14
## 46    41  0.1424   0.00 2012-11-15
## 47  5441 18.8924   0.00 2012-11-16
## 48 14339 49.7882   0.00 2012-11-17
## 49 15110 52.4653   0.00 2012-11-18
## 50  8841 30.6979   0.00 2012-11-19
## 51  4472 15.5278   0.00 2012-11-20
## 52 12787 44.3993   0.00 2012-11-21
## 53 20427 70.9271   0.00 2012-11-22
## 54 21194 73.5903   0.00 2012-11-23
## 55 14478 50.2708   0.00 2012-11-24
## 56 11834 41.0903   0.00 2012-11-25
## 57 11162 38.7569   0.00 2012-11-26
## 58 13646 47.3819   0.00 2012-11-27
## 59 10183 35.3576   0.00 2012-11-28
## 60  7047 24.4688   0.00 2012-11-29
## 61 10766 37.3826  34.11 2012-11-30
```

## Are there differences in activity patterns between weekdays and weekends?

A final analysis was made, looking for differences in the mean of the intervals, in days of week and weekend days. The data was divided, according if came from a day of the week or of a day of weekend.

```r
##WEEK WEEKEND PATTERN (in revised data)
# Creating two levels variable with week and weekend days
days<-as.factor(c("weekday","weekend"))
for (i in 1:length(RD$date)){
  if(weekdays(as.Date(RD$date[i])) == "sabado" || weekdays(as.Date(RD$date[i])) == "domingo")
  {days[i]="weekend"}
  if(weekdays(as.Date(RD$date[i])) != "sabado" & weekdays(as.Date(RD$date[i])) != "domingo")
  {days[i]="weekday"} 
}
RDW<-data.frame(RD,days)

#Grouping data per interval of weekday end weekend
C<-1;D<-1;intervalos<-datos$interval[as.numeric(datos$date)==2]
for (i in 1:length(intervalos)){ 
    C[i]<-mean(RDW$steps[RDW$interval==intervalos[i] & RDW$days=="weekday"])
    D[i]<-mean(RDW$steps[RDW$interval==intervalos[i] & RDW$days=="weekend"])  
}
```


Figures 3 and 4 show the respective pattern for a week day and weekend respectively. 

```r
par(mfrow=c(2,1))
plot(intervalos,C, main=" Figure 3: weekdays")
plot(intervalos,D, main=" Figure 4: weekend")
```

![plot of chunk unnamed-chunk-16](figure/unnamed-chunk-16.png) 


